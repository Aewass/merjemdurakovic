---
import Layout from '../../layouts/Layout.astro';
import Footer from '../../components/Footer.astro';
import { ArrowLeft } from 'lucide-astro';

// Update the types for our data structure
type CatalogImage = {
  src: string;
  alt: string;
  caption?: string;
};

type CatalogItem = {
  name: string;
  description: string;
  images: CatalogImage[];
};

type CategoryData = {
  number: string;
  title: string;
  category: string;
  description: string;
  items: CatalogItem[];
};

export function getStaticPaths() {
  return [
    {
      params: { id: 'catalogs' },
      props: {
        category: {
          number: "01",
          title: "Catalogs",
          category: "Category",
          description: "Collection of product catalogs for various clients",
          items: [
            {
              name: "iform",
              description: "Product catalog collection for iform",
              images: [
                { 
                  src: "/src/assets/catalogs/catalog-iform/1.png", 
                  alt: "iform catalog page 1",
                  caption: "Product showcase page" 
                },
                { 
                  src: "/src/assets/catalogs/catalog-iform/2.png", 
                  alt: "iform catalog page 2",
                  caption: "Technical specifications" 
                }
              ]
            },
            {
              name: "lezaj-trade",
              description: "Product catalog collection for Lezaj Trade",
              images: [
                { src: "/src/assets/catalogs/catalog-lezaj-trade/1.png", alt: "Lezaj Trade catalog page 1" },
                { src: "/src/assets/catalogs/catalog-lezaj-trade/2.png", alt: "Lezaj Trade catalog page 2" },
                { src: "/src/assets/catalogs/catalog-lezaj-trade/3.png", alt: "Lezaj Trade catalog page 3" },
              ]
            },
            {
              name: "mega",
              description: "Product catalog for Mega",
              images: [
                { src: "/src/assets/catalogs/catalog-mega/1.png", alt: "Mega catalog page 1" },
                { src: "/src/assets/catalogs/catalog-mega/2.png", alt: "Mega catalog page 2" },
                { src: "/src/assets/catalogs/catalog-mega/3.png", alt: "Mega catalog page 3" }
              ]
            },
            {
              name: "shams",
              description: "Product catalog collection for Shams",
              images: [
                { src: "/src/assets/catalogs/catalog-shams/1.png", alt: "Shams catalog page 1" },
                { src: "/src/assets/catalogs/catalog-shams/2.png", alt: "Shams catalog page 2" },
                { src: "/src/assets/catalogs/catalog-shams/3.png", alt: "Shams catalog page 3" }
              ]
            },
            {
              name: "stanic",
              description: "Product catalog collection for Stanic",
              images: [
                { src: "/src/assets/catalogs/catalog-stanic/1.png", alt: "Stanic catalog page 1" },
                { src: "/src/assets/catalogs/catalog-stanic/2.png", alt: "Stanic catalog page 2" },
                { src: "/src/assets/catalogs/catalog-stanic/3.jpg", alt: "Stanic catalog page 3" },
              ]
            },
            {
              name: "zgi",
              description: "Product catalog collection for ZGI",
              images: [
                { src: "/src/assets/catalogs/catalog-zgi/1.jpg", alt: "ZGI catalog page 1" },
                { src: "/src/assets/catalogs/catalog-zgi/2.jpg", alt: "ZGI catalog page 2" },
                { src: "/src/assets/catalogs/catalog-zgi/3.jpg", alt: "ZGI catalog page 3" }
              ]
            },
            {
              name: "zgi2",
              description: "Product catalog collection for ZGI (Volume 2)",
              images: [
                { src: "/src/assets/catalogs/catalog-zgi2/1.jpg", alt: "ZGI Vol.2 catalog page 1" },
                { src: "/src/assets/catalogs/catalog-zgi2/2.jpg", alt: "ZGI Vol.2 catalog page 2" },
                { src: "/src/assets/catalogs/catalog-zgi2/3.jpg", alt: "ZGI Vol.2 catalog page 3" }
              ]
            }
          ]
        } as CategoryData
      }
    },
    {
      params: { id: 'visit-cards' },
      props: {
        category: {
          number: "02",
          title: "Visit Cards",
          category: "Category",
          description: "Collection of business cards and visit cards for various clients",
          items: [
            {
              name: "visit-card-lezaj-trade",
              description: "Business card design for Lezaj Trade",
              images: [
                { 
                  src: "/src/assets/visit-cards/visit-card-lezaj-trade/1.jpg", 
                  alt: "Lezaj Trade visit card",
                  caption: "Front design" 
                }
              ]
            },
            {
              name: "visit-card-zerro-max",
              description: "Business card design for Zerro Max",
              images: [
                { 
                  src: "/src/assets/visit-cards/visit-card-zerro-max/2.jpg", 
                  alt: "Zerro Max visit card",
                  caption: "Complete business card design" 
                }
              ]
            }
          ]
        } as CategoryData
      }
    },
    {
      params: { id: 'books' },
      props: {
        category: {
          number: "03",
          title: "Books",
          category: "Category",
          description: "Book designs and layouts for various publications",
          items: [
            {
              name: "book",
              description: "Book design and layout project",
              images: [
                { 
                  src: "/src/assets/books/book/1.jpg", 
                  alt: "Book design page 1",
                  caption: "Cover design" 
                },
                { 
                  src: "/src/assets/books/book/2.jpg", 
                  alt: "Book design page 2",
                  caption: "Internal layout" 
                },
                { 
                  src: "/src/assets/books/book/3.jpg", 
                  alt: "Book design page 3",
                  caption: "Chapter opening page" 
                }
              ]
            }
          ]
        } as CategoryData
      }
    },
    {
      params: { id: 'print-media' },
      props: {
        category: {
          number: "04",
          title: "Print Media",
          category: "Category",
          description: "Various print media designs including flyers, brochures, and trifolds",
          items: [
            {
              name: "fascicle-zerromax",
              description: "Fascicle design for Zerromax",
              images: [
                { 
                  src: "/src/assets/print-media/fascicle-zerromax/1.jpg", 
                  alt: "Zerromax fascicle design page 1",
                  caption: "Front cover design" 
                },
                { 
                  src: "/src/assets/print-media/fascicle-zerromax/2.jpg", 
                  alt: "Zerromax fascicle design page 2",
                  caption: "Interior spread" 
                }
              ]
            },
            {
              name: "flyer-adblue",
              description: "Promotional flyer for AdBlue",
              images: [
                { 
                  src: "/src/assets/print-media/flyer-adblue/1.jpg", 
                  alt: "AdBlue flyer design",
                  caption: "Single page promotional flyer" 
                }
              ]
            },
            {
              name: "flyer-doma",
              description: "Promotional flyer for Doma",
              images: [
                { 
                  src: "/src/assets/print-media/flyer-doma/1.jpg", 
                  alt: "Doma flyer design",
                  caption: "Marketing flyer design" 
                }
              ]
            },
            {
              name: "flyer-palma",
              description: "Promotional flyer for Palma",
              images: [
                { 
                  src: "/src/assets/print-media/flyer-palma/1.jpg", 
                  alt: "Palma flyer design",
                  caption: "Product promotion flyer" 
                }
              ]
            },
            {
              name: "flyer-phoenix",
              description: "Promotional flyer for Phoenix",
              images: [
                { 
                  src: "/src/assets/print-media/flyer-phoenix/1.jpg", 
                  alt: "Phoenix flyer design",
                  caption: "Event promotional material" 
                }
              ]
            },
            {
              name: "flyer-shams",
              description: "Promotional flyer for Shams",
              images: [
                { 
                  src: "/src/assets/print-media/flyer-shams/1.jpg", 
                  alt: "Shams flyer design",
                  caption: "Product showcase flyer" 
                }
              ]
            },
            {
              name: "trifold-artane",
              description: "Trifold brochure design for Artane",
              images: [
                { 
                  src: "/src/assets/print-media/trifold-artane/1.jpg", 
                  alt: "Artane trifold brochure page 1",
                  caption: "Front panel design" 
                },
                { 
                  src: "/src/assets/print-media/trifold-artane/2.jpg", 
                  alt: "Artane trifold brochure page 2",
                  caption: "Interior panels layout" 
                },
                { 
                  src: "/src/assets/print-media/trifold-artane/3.jpg", 
                  alt: "Artane trifold brochure page 3",
                  caption: "Back panel design" 
                }
              ]
            }
          ]
        } as CategoryData
      }
    }
  ];
}

const { id } = Astro.params;
const { category } = Astro.props;
---

<Layout title={`${category.title} - ${category.category}`}>
  <main class="relative min-h-screen">
    <div class="fixed inset-0">
      <div class={`absolute inset-0 bg-[radial-gradient(circle_at_top,_var(--tw-gradient-stops))] ${
        id === 'visit-cards'
          ? 'from-rose-200/40 via-rose-100/30 to-transparent' 
          : id === 'books'
            ? 'from-emerald-200/40 via-emerald-100/30 to-transparent'
            : id === 'print-media'
              ? 'from-amber-200/40 via-amber-100/30 to-transparent'
              : 'from-purple-200/40 via-purple-100/30 to-transparent'
      }`}></div>
    </div>

    <div class="relative">
      <article class="pt-32 pb-24">
        <div class="max-w-6xl mx-auto px-6 sm:px-8">
          <!-- Back Button -->
          <a 
            href="/#portfolio" 
            class={`
              inline-flex 
              items-center 
              gap-2 
              text-gray-500 
              ${
                id === 'visit-cards' ? 'hover:text-rose-600' : 
                id === 'books' ? 'hover:text-emerald-600' : 
                id === 'print-media' ? 'hover:text-amber-600' :
                'hover:text-purple-600'
              }
              transition-colors 
              duration-300 
              mb-12 
              group
            `}
          >
            <ArrowLeft class="w-4 h-4 group-hover:-translate-x-1 transition-transform duration-300" />
            <span class="text-sm">Back to Portfolio</span>
          </a>

          <!-- Header -->
          <header class="mb-16">
            <div>
              <div class={`flex items-center gap-2 ${
                id === 'visit-cards' ? 'text-rose-600' : 
                id === 'books' ? 'text-emerald-600' : 
                id === 'print-media' ? 'text-amber-600' :
                'text-purple-600'
              } mb-4`}>
                <span class="font-mono">{category.number}</span>
                <span class="text-gray-300">â€”</span>
                <span>{category.category}</span>
              </div>
              <h1 class="text-5xl font-bold mb-6">
                {category.title}
              </h1>
              <p class="text-xl text-gray-600 max-w-2xl">
                {category.description}
              </p>
            </div>
          </header>

          <!-- Catalogs List -->
          <div class="space-y-40">
            {category.items.map(item => (
              <div class="catalog-item">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 md:gap-16 items-start">
                  <div>
                    <h2 class="text-4xl font-bold mb-4 capitalize">{item.name.replace('-', ' ')}</h2>
                    <p class="text-lg text-gray-600 mb-8">{item.description}</p>
                    <div class="flex items-center">
                      <span class={`inline-flex items-center py-1.5 px-3 ${
                        id === 'visit-cards' ? 'bg-rose-50/70' : 
                        id === 'books' ? 'bg-emerald-50/70' : 
                        id === 'print-media' ? 'bg-amber-50/70' :
                        'bg-purple-50/70'
                      } text-sm text-gray-800 rounded-full`}>
                        <span class={`w-1.5 h-1.5 ${
                          id === 'visit-cards' ? 'bg-rose-500' : 
                          id === 'books' ? 'bg-emerald-500' : 
                          id === 'print-media' ? 'bg-amber-500' :
                          'bg-purple-500'
                        } rounded-full mr-2`}></span>
                        {item.images.length} {item.images.length === 1 ? 'page' : 'pages'}
                      </span>
                    </div>
                  </div>
                  
                  {/* Check if it's a visit card (single image) */}
                  {id === 'visit-cards' ? (
                    <div class="relative perspective-1000 max-w-lg mx-auto lg:mx-0">
                      {item.images.map((image, index) => (
                        <div 
                          class="relative bg-white rounded-lg shadow-xl border border-rose-200 overflow-hidden transition-all duration-500 hover:shadow-2xl hover:-translate-y-2"
                        >
                          <div class="group cursor-pointer">
                            <img 
                              src={image.src} 
                              alt={image.alt} 
                              class="w-full h-full object-cover hover:scale-105 transition-transform duration-500"
                              data-fullview={image.src}
                            />
                            {image.caption && (
                              <div class="absolute bottom-0 left-0 right-0 bg-black/70 text-white p-2 text-sm opacity-0 group-hover:opacity-100 transition-opacity">
                                {image.caption}
                              </div>
                            )}
                          </div>
                        </div>
                      ))}
                      <div class="absolute -bottom-4 -right-4 -z-10 w-full h-full bg-gradient-to-r from-rose-400/20 to-rose-200/20 rounded-lg"></div>
                    </div>
                  ) : (
                    /* Mosaic Grid for Catalogs */
                    <div class="image-mosaic relative">
                      <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                        {item.images.map((image, index) => (
                          <div class={`overflow-hidden rounded-lg bg-white shadow-md transition-all duration-300 hover:shadow-xl ${
                            index === 0 ? 'col-span-2 row-span-2' : ''
                          }`}>
                            <div class="relative group cursor-pointer aspect-[4/3]">
                              <img 
                                src={image.src} 
                                alt={image.alt || `${item.name} image ${index + 1}`}
                                class="w-full h-full object-cover hover:scale-105 transition-transform duration-500"
                                data-fullview={image.src}
                              />
                              {image.caption && (
                                <div class="absolute bottom-0 left-0 right-0 bg-black/70 text-white p-2 text-sm opacity-0 group-hover:opacity-100 transition-opacity">
                                  {image.caption}
                                </div>
                              )}
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}
                  
                  <!-- Full-size image viewer (hidden by default) -->
                  <div id="imageViewer" class="fixed inset-0 bg-black/90 z-50 hidden flex items-center justify-center">
                    <button id="closeViewer" class="absolute top-6 right-6 text-white hover:text-gray-300">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                      </svg>
                    </button>
                    <img id="fullImage" src="" alt="Full size image" class="max-h-[90vh] max-w-[90vw] object-contain" />
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </article>

      <Footer />
    </div>
  </main>
</Layout>

<script>
  // Initialize image viewers for all images with data-fullview
  document.querySelectorAll('img[data-fullview]').forEach(img => {
    img.addEventListener('click', () => {
      const fullview = img.getAttribute('data-fullview');
      const viewer = document.getElementById('imageViewer');
      const fullImage = document.getElementById('fullImage') as HTMLImageElement;
      
      if (fullview && viewer && fullImage) {
        fullImage.src = fullview;
        fullImage.alt = (img as HTMLImageElement).alt;
        viewer.classList.remove('hidden');
        viewer.classList.add('flex');
        
        // Prevent scrolling on body
        document.body.style.overflow = 'hidden';
      }
    });
  });
  
  // Close viewer
  document.getElementById('closeViewer')?.addEventListener('click', () => {
    const viewer = document.getElementById('imageViewer');
    if (viewer) {
      viewer.classList.add('hidden');
      viewer.classList.remove('flex');
      
      // Restore scrolling
      document.body.style.overflow = '';
    }
  });
  
  // Close on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      const viewer = document.getElementById('imageViewer');
      if (viewer && !viewer.classList.contains('hidden')) {
        viewer.classList.add('hidden');
        viewer.classList.remove('flex');
        document.body.style.overflow = '';
      }
    }
  });
</script>

<style>
  .image-mosaic img {
    transition: transform 0.3s ease;
  }
  
  .image-mosaic img:hover {
    transform: scale(1.05);
  }
</style> 